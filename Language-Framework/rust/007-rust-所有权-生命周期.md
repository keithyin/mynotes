å†…å­˜å®‰å…¨é—®é¢˜ï¼š
* é”™è¯¯çš„å†…å­˜è®¿é—®ï¼šè¯»å–æœªåˆå§‹åŒ–å†…å­˜ï¼›è§£å¼•ç”¨ç©ºæŒ‡é’ˆï¼›ç¼“å­˜æº¢å‡º
* è¿åç”Ÿå‘½å‘¨æœŸï¼šinvalid freeï¼›use after free; double free

çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š
* æ­»é”ï¼›data race

# rustæ‰€æœ‰æƒ
> rust çš„åŸºç¡€è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³çš„ï¼Ÿ

rust æ‰€æœ‰æƒè§„åˆ™ï¼Œ**é»˜è®¤æƒ…å†µä¸‹**ï¼š ï¼ˆä¿è¯æ‰€æœ‰çš„èµ„æºèƒ½å¤Ÿæ­£ç¡®çš„é‡Šæ”¾ï¼‰
> æ‰€æœ‰æƒè§„åˆ™å®é™…æ˜¯é’ˆå¯¹å †å†…å­˜çš„ï¼Œæ ˆå†…å­˜åªæ˜¯é™„å¸¦å½±å“äº†è€Œå·²ã€‚

* Each value in Rust has a variable thatâ€™s called its owner.
* There can only be one owner at a time. 
* When the owner goes out of scope, the value will be dropped.

æ¥çœ‹ä¸€ä¸‹rustæ˜¯å¦‚ä½•ä¿è¯è¿™äº›è§„åˆ™çš„ï¼š
* Each value in Rust has a variable thatâ€™s called its owner.
* There can only be one owner at a time. 
	* é€šè¿‡ `=` è¿ç®—ç¬¦çš„ç§»åŠ¨è¯­æ„æ¥ ä¿è¯ã€‚ç§»åŠ¨çš„å®é™…æ“ä½œæ˜¯ï¼šå¤åˆ¶æ ˆæ•°æ®ï¼Œå°†åŸå§‹çš„ownerç½®ä¸ºä¸å¯ç”¨ï¼è¿™æ ·å°±é˜²æ­¢äº†å†…å­˜é—®é¢˜ double free
	* å¦‚æœ `=` è¿ç®—ç¬¦å¯¹äºæ‰€æœ‰çš„ç±»å‹ï¼Œéƒ½æ˜¯ç§»åŠ¨è¯­æ„çš„è¯ï¼Œé‚£ä¹ˆå¯¹äºæ ˆæ•°æ®å°±ä¸å…¬å¹³äº†ï¼Œæˆ‘åˆä¸ä¼šå­˜åœ¨ double free é—®é¢˜ï¼Œä¸ºå•¥æˆ‘éœ€è¦å°†åŸå§‹ ownerç½®ä¸º ä¸å¯ç”¨å‘¢ï¼Ÿæ‰€ä»¥ rust æä¾›äº†Copy traitæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…·æœ‰ Copy trait çš„ç±»å‹ï¼Œ`=` æ˜¯å¤åˆ¶è¯­æ„ã€‚ï¼ˆä»…æ ˆä¸Šæ•°æ®å¤åˆ¶ï¼Œå¹¶ä¸éœ€è¦å°†åŸå§‹ownerç½®ä¸ºä¸å¯ç”¨ï¼‰
	* ğŸ¤”ï¸ï¼šä¸ºå•¥ä¸ä¸€é”…ç«¯å‘¢ï¼Ÿæ ˆä¸Šæ•°æ®ä¹Ÿæ˜¯ç§»åŠ¨è¯­æ„æœ‰å•¥é—®é¢˜å—ï¼Ÿ
```rust
fn main(){
    let b = String::from("hh2");
    let c = b; // ç§»åŠ¨è¯­æ„ï¼Œåé¢ï¼Œbå°†ä¸å†å¯ç”¨ã€‚
}
```

* When the owner goes out of scope, the value will be dropped. ï¼ˆç¡®ä¿åˆ†é…çš„å†…å­˜çš„ä¼šæ­£ç¡®çš„å›æ”¶ï¼‰
	* é€šè¿‡ Drop trait æ¥ç¡®ä¿èµ„æºèƒ½å¤Ÿæ­£ç¡®çš„å›æ”¶â™»ï¸
```rust
fn main(){
    { 
      let b = String::from("hh2");
    } // bç¦»å¼€ä½œç”¨åŸŸï¼Œå…¶ç®¡ç†çš„å †å†…å­˜ä¼šè¢« drop
    
    let mut b = String::from("hh2");
    b = String::from("hh3"); // è¿™æ—¶ï¼ŒåŸæ¥b owner çš„ ç©ºé—´ä¹Ÿä¼šè¢« drop çš„å§ã€‚
}
```

## ä¸å¯å˜å¼•ç”¨ & å¯å˜å¼•ç”¨ï¼ˆå€Ÿç”¨ï¼‰

æ¥çœ‹ å¼•ç”¨ & å€Ÿç”¨ éœ€è¦éµå®ˆå“ªäº›è§„åˆ™

* At any given time, you can have either one mutable reference or any number of immutable references.
	* å¯ä»¥å¤šä¸ªå¼•ç”¨å­˜åœ¨
	* åªèƒ½æœ‰ä¸€ä¸ªå€Ÿç”¨å­˜åœ¨ï¼Œä¸”å€Ÿç”¨å’Œå¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨
* References must always be valid.

ä¸ºä»€ä¹ˆè¦éµå®ˆè¿™äº›è§„åˆ™
* At any given time, you can have either one mutable reference or any number of immutable references.
	* ç¼–è¯‘æœŸå°±èƒ½é¿å… å¹¶è¡Œç¼–ç¨‹æ—¶ç¢°åˆ°çš„data raceé—®é¢˜ã€‚å½“ä»¥ä¸‹3ä¸ªè¡Œä¸ºåŒæ—¶å‘ç”Ÿæ—¶ï¼Œå°±ä¼šå‡ºç°data raceï¼š1ï¼‰å¤šä¸ªæŒ‡é’ˆåŒæ—¶è®¿é—®ä¸€å—å†…å­˜ï¼Œ2ï¼‰è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆç”¨æ¥å†™è¿™å—å†…å­˜ï¼Œ3ï¼‰å¹¶æ²¡æœ‰æœºåˆ¶æ¥åŒæ­¥è¿™å—å†…å­˜çš„è®¿é—®
	* è¯¥æœºåˆ¶èƒ½å¤Ÿæ­£ç¡®çš„ä¿è¯ æ ˆå†…å­˜ ä¸ä¼šå‡ºç° data raceé—®é¢˜
	* å½“ç„¶ï¼šè¯¥è§„åˆ™è¿˜ä¼šæœ‰ä¸€äº›å…¶å®ƒçš„è¯¡å¼‚çš„å½±å“ã€‚ã€‚ã€‚ã€‚ã€‚ 
* References must always be valid.
	* é˜²æ­¢ dangling pointer

rust ä½¿ç”¨ä»€ä¹ˆæœºåˆ¶ä¿è¯æˆ‘ä»¬éµå®ˆè¯¥è§„åˆ™
* At any given time, you can have either one mutable reference or any number of immutable references.
	* æ²¡ä»”ç»†ç ”ç©¶ï¼Œä¸çŸ¥é“
* References must always be valid.
	* ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ã€‚éœ€è¦æˆ‘ä»¬ **æ­£ç¡®çš„è¿›è¡Œ** ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨



# rusté€šè¿‡å“ªäº›æœºåˆ¶ä¿è¯äº† å†…å­˜å®‰å…¨&å¹¶å‘å®‰å…¨
https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-798.pdf


å†…å­˜å®‰å…¨é—®é¢˜ï¼š
* é”™è¯¯çš„å†…å­˜è®¿é—®ï¼š
	* è¯»å–æœªåˆå§‹åŒ–å†…å­˜ï¼›rustä¿è¯å†…å­˜çš„åˆå§‹åŒ–ï¼Ÿ
	* è§£å¼•ç”¨ç©ºæŒ‡é’ˆï¼›
	* ç¼“å­˜æº¢å‡º; 
* è¿åç”Ÿå‘½å‘¨æœŸï¼šä½¿ç”¨ownershipä¿®ç†äº†
	* invalid freeï¼›
	* use after free; 
	* double free

çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š
* æ­»é”ï¼›æ²¡æœ‰è§£å†³
* data raceï¼›

ä¸Šè¿°çš„ å¼•ç”¨&å€Ÿç”¨è§„åˆ™ï¼Œä»…ä»…æ˜¯æ§åˆ¶ä½äº†


