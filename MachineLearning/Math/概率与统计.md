# 统计推断

术语：（统计推断术语对应于机器学习术语）

* 模型推断：模型的参数学习
* 变量推断：inference
* 参数统计推断 vs 非参数统计推断 （参数估计 vs 非参数估计）
  * 参数估计：参数空间维度是有限的，（对于神经网络模型来说，大都是参数估计）
  * 非参数估计：参数的空间维度是无限的（比如：每个样本一个参数，随着样本增长，参数的数量也会增长）



* 首先有一个推断的目标
* 再者是按照什么样的标准来进行估计：最大后验概率？最小均方误差？或者直接随机估算一个值得了？
* 根据标准可以得到一个 estimator
* 然后判断一下这个estimator是有偏的还是无偏的。



# 推断总体参数

推断总体参数有两种方法：

1. 估计未知参数值 （参数估计）：点估计，区间估计
2. 对参数的假设值进行决策 （假设检验）

## 估计未知参数值

假设我们要估计一个总体参数，记作 $\theta$ ，其可能是：$\mu, \sigma^2, F(a), ...$ 。均值，方差，小于某个值的概率 等

### 点估计

> 用样本计算一个点的规则

估计值使用 $\hat \theta$ 表示，点估计是如何利用观测样本计算出 $\hat \theta$ 的公式。$\hat\theta=f(Y_1, Y_2, Y_3, ...)$ 

#### 矩法求点估计



#### 极大似然法



#### 最小二乘法





### 区间估计

> 用样本计算两个点的规则

会经常用到大数定理的知识。

* **样本均值** 的抽样分布近似为正态分布（大样本前提下），其均值为 $\mu$ 方差为 $\frac{\sigma}{\sqrt n}$

通常会使用 **样本均值 & 样本方差** 来构建一个 **总体均值** 的区间估计



区间估计的方法

1. 枢轴统计量：样本值和要估计的参数的一个函数。（也是一个随机变量
2. 。。。
3. 。。。



#### 枢轴统计量（pivotal method）

> 如果 $\hat\theta$ 的抽样分布近似高斯分布，其均值为 $\theta$ 方差为 $\sigma_{\hat \theta}$ 那么就可以使用标准正态分布作为其枢轴统计量了
>
> $Z=\frac{\hat \theta - \theta}{\sigma_{\hat\theta}}$, 我们可以根据该枢轴统计量和已知样本来计算出 $\theta$ 的取值范围，显而易见，$\theta$ 是通过样本统计量 $\theta, \sigma_{\hat\theta}$ 计算得到的
>
> 假设我们想要得到 95%置信区间，那么应该怎么算呢？
> $$
> \begin{aligned}
> P(-z_{\alpha/2} \le Z\le z_{\alpha/2}) &= 0.95 \\
> P(-z_{\alpha/2}\sigma_{\hat\theta} \le \hat\theta - \theta \le z_{\alpha/2}\sigma_{\hat\theta}) &= 0.95 \\
> P(-\hat\theta-z_{\alpha/2}\sigma_{\hat\theta} \le  - \theta \le -\hat\theta + z_{\alpha/2}\sigma_{\hat\theta}) &= 0.95 \\
> P(\hat\theta-z_{\alpha/2}\sigma_{\hat\theta} \le  \theta \le + \hat\theta + z_{\alpha/2}\sigma_{\hat\theta}) &= 0.95
> \end{aligned}
> $$
> 我们可以通过查表来找到 $z_{\alpha/2}$ 的值，然后根据上面最后一行的表达式就得到 $\theta$ 的 95%置信区间了
>
> **枢轴统计量** 都是可以通过简单的查表来找到其对应的概率区间对应的x轴的值的

* 大样本均值：我们可以通过高斯分布来近似（**使用标准正态分布作为其枢轴统计量**）
  * $n\ge 30$ 就可以称之为大样本了
* 小样本均值: 使用 $T$ 分布作为枢轴统计量
* 两个总体均值差：大样本使用 标准正态分布，小样本使用 $T$分布，也可以使用样本匹配法进行估计（也是正态分布 or $T$分布）
* 总体方差：$\chi^2$分布作为枢轴统计量
* 两个总体方差比：$F$分布作为枢轴统计量



### 假设检验

> 假设检验基本操作流程是：确定一个原假设，然后通过样本证据指出原假设是不真实的，以证明对备择假设的支持
>
> 是否拒绝原假设依赖于一个由样本数据算得的统计量，称作 **检验统计量**
>
> **检验统计量** 是一个随机数，其取值范围包含两个域：
>
> 1. 拒绝域：当检验统计量取这个域的值时，将拒绝原假设，选择备择假设
> 2. 接受域：当检验统计量取这个域的值时，接受原假设
>
> 统计检验的5要素：
>
> 1. 原假设 $H_0$
> 2. 备择假设 $H_a$
> 3. 检验统计量，由样本数据计算得到的 (**可以是率，可以是计数， 还可以是其它**)
> 4. 拒绝域：使得原假设被拒绝的 **检验统计量** 的取值
> 5. 结论：做出拒绝还是接受原假设的决策
>
> 两类错误
>
> * $I$类错误：原假设为真，但是被拒绝。犯$I$类错误的概率使用 $\alpha$ 表示
> *  $II$类错误：原假设为假，但是被接受。犯$II$类错误的概率使用 $\beta$ 表示



一般假设检验的步骤为：

1. 原假设
2. 在原假设的情况下，检验统计量出现的概率是多少
3. 如果出现的概率低于某个值，那就拒绝原假设



如何计算 $I$类错误率：即 $H_0$ 实际为真，但是被当前样本拒绝的概率（检验统计量落入了拒绝域）

> 1. 假设 $H_0$ 为真
> 2. 在 $H_0$ 为真时，检验统计量在拒绝域中的概率
> 3. 该概率就是 $I$类错误率
>
> 可以看出，计算 $I$类错误率的时候，并不需要真实样本



##### 似然比检验统计量

$$
\lambda = \frac{假定\theta=\theta_0时的似然函数}{假定\theta=\hat\theta时的似然函数}=\frac{L(\theta_0)}{L(\hat\theta)}
$$

> 其中 $\hat\theta$ 为 $\theta$的最大似然估计，假设检验的拒绝域可以由 $\lambda_R$ 的取值范围构成



##### 使用枢轴统计量 进行假设检验





> 假设检验流程：
>
> 1. 确定原假设
> 2. 确定备择假设
> 3. 确定检验统计量
> 4. 确定 $\alpha$, 根据 $\alpha$ 得到假设统计量的拒绝域
> 5. 根据样本计算检验统计量，看得到的值是否在拒绝域中
>
> 报告$p值$的假设检验
>
> 1. 确定原假设
> 2. 确定备择假设
> 3. 确定检验统计量
> 4. 根据样本计算检验统计量的值
> 5. 计算在原假设下，该值出现的概率，即 $p值$

