
# 计算广告
## pv 视角：
> 目前计算广告系统就是这么实现的
* pv来到服务器
* 召回所该user相关的广告 （召回）
* 根据cpm对广告进行排序
* 向用户展示广告
* 用户是否点击该广告（如果点击，则归因到此次eshow）
	* 点击了
		* 该收钱了。收益&成本 都归因该次点击
		* 是否转化。如果转化，归因到此次点击
	* 没点击
		* 没后序了
		* 
* 点击 & 转化 落日志。模型开始根据日志进行训练。

## 广告主视角

* 我是广告主，投广告，有预算
* 我想提高广告投放的roi，所有最好是在合适的时间（RTB系统竞争少的时候），投放给合适的人（能提升我roi的）

# 红包营销

## pv 视角

* pv来到服务器。这里的pv不是一般的page view。
* 召回该用户相关的所有营销任务（有时候为了同一个目的，会配置多个营销任务）
* 选择一个营销任务发给用户
	* 用户转化了
		* 如果用券了，收钱。如果没有用券，不收钱。
		* 转化如何归因？成本如何归因？
	* 用户没转化
		* 没后序了

* 如果这次没有发营销任务给用户
	* 用户转化了
		* 用了之前发的券，收钱。如果没有用券，不收钱
		* 转化如何归因？成本如何归因？
	* 用户没转化 
		* 没有后序了
* 营销任务发送日志 & 转化日志 & 用券日志。模型开始进行训练


# RTB
> 出价和计费不一样，计费方式一般是GSP/VCG

> 出价方式：展现，点击，转化，直接给预算（适用于广告主也不知道如何）

> 计费方式：展现，点击，转化

> 拍卖机制：一堆广告，哪个广告应该竞得该条pv


* CPM: 展现出价，展现计费
	* 广告主视角：朴素的按照pv出价，**pv价值一视同仁**。
	* 广告平台视角：一个pv过来，召回的广告按照cpm排序，给该用户展示，展示就收费。按照GSP/VCG收费
* CPC：点击出价，点击计费
	* 广告主视角：朴素的按照click出价，**click价值一视同仁**。
	* 广告平台视角：一个pv过来，召回的广告预估ctr，根据ctr预估cpm，按照cpm排序，挑top的进行展示。如果点击，按照点击计费（GSP/VCG）
* OCPM：点击出价，展现计费
	* 广告主视角：点击/转化/预算 出价，**pv的价值由广告系统决定**
	* 广告平台视角：一个pv过来，召回的广告预估ctr，根据ctr预估cpm，按照cpm排序，挑top展示。然后计费
* OCPC：转化出价，点击计费
	* 广告主视角：按照转化/预算出价，**点击的价值由广告系统决定**
	* 广告平台视角：一个pv过来，召回的广告预估ctr & cvr，根据ctr * cvr * cvr_bid 预估cpm，按照cpm排序，挑top展示。如果点击，则计费
* CPA：转化出价，转化计费。A为action，可以根据action进行出价
	* 广告主视角：按照转化出价，**转化的价值一视同仁**
	* 广告平台视角：一个pv过来，召回的广告预估 ctr & cvr，根据 ctr * cvr * cvr_bid 预估 cpm，按照cpm排序，挑top展示。如果转化，则计费
* BCB：budget constrained bidding. 
	* 广告视角：只给出预算，钱怎么花都行
	* 广告平台视角：确定该广告的计费策略（展现/点击/转化）。然后将预算分配到（展现/点击/转化）。然后按照上述方法求解？

**无论上面什么样的产品形式，广告系统总是要为该广告出一个cpm价格的，该价格决定该广告是否竞得该流量。**

如果想提高广告主ROI，广告平台应该怎么做
* 从pv对该广告的价值考虑，如果价值高，就提高出价，如果价值低，就出价低。最终转成统一的cpm去竞价。

如果想提高用户体验：
* 出ctr高的广告
* 出使得用户的时常高的广告

如果想提高平台收益：
* 保证cpm不降低。如何保证cpm不降低呢？

从优化广告主ROI角度来看技术。
> 
* CPM -> OCPM：广告主投了CPM广告，但是广告主的ROI是点击。

