
# 存储格式
fasta格式存储 DNA序列


fasta格式：
1. 第一行 > 开头，然后后面写一堆东西
2. 第二行开始：纯序列部分，除了序列什么都不要写
```
> desc
ATCGGGGGTAAAAC
```


# 为什么需要比对

相似的序列往往对应着相似的功能。

# 序列比对指标

* 序列一致度：如果两个序列长度相同，那么一致度定义为。对应位置上相同的 个数 占 总体个数的百分比
* 序列相似度：相似的个数占总体个数的百分比。相似度的计算需要一个替换计分矩阵

* 替换计分矩阵：反映残基之间相互替换率的矩阵，它描述了两两相似的量化关系。分为DNA替换计分矩阵 和 蛋白质替换计分矩阵

```
CLHK
CIHL

* 一致度：1/2。（相同的个数 / 总个数）
* 相似度：需要一个替换计分矩阵 （(相同个数+相似个数) / 总个数）

# 一个DNA替换计分矩阵
  A  T  C  G
A 5 -4 -4 -4
T -4 5 -4 -4
C -4 -4 5 -4
G -4 -4 -4 5

```

## 替换计分矩阵

### DNA有三种
1. 等价矩阵(unitary matrix)：相同是1，不同是0。（不常用，只在理论计算上用）
2. 转换-颠换矩阵 (transition-transversion matrix): 核酸的碱基按照环结构被分为两类，一类是 嘌呤（腺嘌呤A，鸟嘌呤G），他们有两个环。另一类是嘧啶（胞嘧啶C、胸腺嘧啶T），他们只有一个环。如果DNA碱基的替换保持环数不变，则成为转换。如果环数发生变化，则称为 颠换。在进化过程中，转化的发生概率大于颠换的发生概率
3. BLAST矩阵：经过大量的实际比对发现，如果被对比的两个核苷酸 相同时 为 5，反之为 -4，则比对效果较好。这个矩阵广泛的被DNA序列比对采用
  1. 比对好的定义是啥

```
# 等价矩阵
  A  T  C  G
A 1  0  0  0
T 0  1  0  0
C 0  0  1  0
G 0  0  0  1

# 转换-颠换矩阵
  A  T  C  G
A 1 -5 -5 -1
T -5 1 -1 -5
C -5 -1 1 -5
G -1 -5 -5 1

# blast 矩阵
  A  T  C  G
A 5 -4 -4 -4
T -4 5 -4 -4
C -4 -4 5 -4
G -4 -4 -4 5
```
### 常见的三种蛋白质 替换计分矩阵

1. 等价矩阵
2. PAM矩阵（Dayhoff 突变数据矩阵）：基于进化原理。如果两种氨基酸替换频繁，说明自然界易接受这种替换。
3. BLOSUM矩阵：BLOSUM-62
4. 遗传密码矩阵
5. 疏水矩阵

# 比较两个序列的方法

## 打点法
```
seq1: HELLO
seq2: HOLY

  H E L L O
H x 
O         x
L     x x
Y
```
len(seq1) * len(seq2) 次比较。
* 打点矩阵中。对角线，和对角线的平行线，标明的是两个序列中相同的区域
* 如果对角线比较明显，那么可以说明这两个序列是比较相似的。
* 没办法定量的描述，但是因为可以可视化。


## 序列比对法 (alignment)
> 序列比对：运用特定的算法找到 两个 或 多个序列之间 产生的 **最大相似度得分** 的 **空格插入** 和 **序列排列** 方案
> 序列s和t比对：把s和t这两个字符串 上下排列起来，把某些位置插入空格（空位，gap），然后依次比较它们在每一个位置上字符的匹配情况，从而找出使这两条序列
> 通过插入空格，将两个 字符串 相同的和相似的 尽量的 对在一起！。

双序列比对算法分为：全局比对 和 局部比对 两种
* 全局比对：全长比对，一个字符都不能落下
* 局部比对：比对对齐的比较好的局部

### global alignment
双序列全局比对算法：Needleman-Wunsch算法，动态规划应用于两条序列的全局比对。

```
    A    G    C    T    -
A   10   -1   -3   -4  -5
G   -1    7   -5   -3   -5
C   -3   -5    9    0   -5
T   -4   -3    0    8   -5
-   -5   -5   -5   -5   0
```

如果替换计分矩阵比较简单。那么就是编辑距离了。这个替换计分矩阵是怎么得到的。

```
s(0, 0) = 0
s(0, j) = gap * j
s(i, 0) = gap * i

// 三个位置来转移
s(i, j) = max(s(i-1, j-1) + w(i, j), s(i-1, j) + gap, s(i, j-1) + gap))
```



### local alignment

### blast (basic local alignment search tool)

> 近似局部比对
> 能不能用 embedding  based alignment？


基本局部比对搜索工具，是目前最常用的数据库搜索程序。

BLAST的原理很简单，要点是 **片段对** 的概念。所谓片段对是指两个给定序列中的一对子序列，他们的长度相等，且可形成无空位的 **完全匹配**。

BLAST 首先找到探测序列和目标序列间所有的匹配程度超过一定阈值的序列片段对，然后对片段对 根据给定的相似性阈值进行延申，得到一定长度的相似性片段，最后给出高分值 **片段对** （high-scoring pairs， HSPs）。改进后的blast允许空位的插入。
