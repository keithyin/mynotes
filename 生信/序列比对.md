
# 存储格式
fasta格式存储 DNA序列


fasta格式：
1. 第一行 > 开头，然后后面写一堆东西
2. 第二行开始：纯序列部分，除了序列什么都不要写
```
> desc
ATCGGGGGTAAAAC
```

# 为什么需要比对

相似的序列往往对应着相似的功能。

# 序列比对指标

* 序列一致度：如果两个序列长度相同，那么一致度定义为。对应位置上相同的 个数 占 总体个数的百分比
* 序列相似度：相似的个数占总体个数的百分比。相似度的计算需要一个替换计分矩阵

* 替换计分矩阵：反映残基之间相互替换率的矩阵，它描述了两两相似的量化关系。分为DNA替换计分矩阵 和 蛋白质替换计分矩阵

```
CLHK
CIHL

* 一致度：1/2
* 相似度：需要一个替换计分矩阵

# 一个DNA替换计分矩阵
  A  T  C  G
A 5 -4 -4 -4
T -4 5 -4 -4
C -4 -4 5 -4
G -4 -4 -4 5

```

## 替换计分矩阵

DNA有三种
1. 等价矩阵(unitary matrix)：相同是1，不同是0
2. 转换-颠换矩阵 (transition-transversion matrix): 核酸的碱基按照环结构被分为两类，一类是 嘌呤（腺嘌呤A，鸟嘌呤G），他们有两个环。另一类是嘧啶（胞嘧啶C、胸腺嘧啶T），他们只有一个环。如果DNA碱基的替换保持环数不变，则成为转换。如果环数发生变化，则称为 颠换。在进化过程中，转化的发生概率大于颠换的发生概率
3. BLAST矩阵：经过大量的实际比对发现，如果被对比的两个核苷酸 相同时 为 5，反之为 -4，则比对效果较好。这个矩阵广泛的被DNA序列比对采用

```
# 等价矩阵
  A  T  C  G
A 1  0  0  0
T 0  1  0  0
C 0  0  1  0
G 0  0  0  1

# 转换-颠换矩阵
  A  T  C  G
A 1 -5 -5 -1
T -5 1 -1 -5
C -5 -1 1 -5
G -1 -5 -5 1

# blast 矩阵
  A  T  C  G
A 5 -4 -4 -4
T -4 5 -4 -4
C -4 -4 5 -4
G -4 -4 -4 5

```


# global alignment

# local alignment

# blast (basic local alignment search tool)

> 近似局部比对
> 能不能用 embedding  based alignment？


基本局部比对搜索工具，是目前最常用的数据库搜索程序。

BLAST的原理很简单，要点是 **片段对** 的概念。所谓片段对是指两个给定序列中的一对子序列，他们的长度相等，且可形成无空位的 **完全匹配**。

BLAST 首先找到探测序列和目标序列间所有的匹配程度超过一定阈值的序列片段对，然后对片段对 根据给定的相似性阈值进行延申，得到一定长度的相似性片段，最后给出高分值 **片段对** （high-scoring pairs， HSPs）。改进后的blast允许空位的插入。
