
# 内存管理

* 字/字节：处理器的最小可寻址单位
* 页（物理内存）：内核将其作为内存管理的基本单元
  *  假设一个页 8 KB，物理内存 8G，那么可以分为 1024 * 1024 个页。每个页都对应了一个结构体(struct page)来表示页当前状态
  *  struct page对应的是物理内存，而非虚拟内存
  *  都做了什么管理？
    *  当前页是否空闲
    *  如果不空闲，谁拥有了这个页。拥有者是 用户空间进程、动态分配的内核数据、静态内核代码、页高速缓存？
*  区：多个页会构成一个区，区是按照功能划分的。
  *  为了解决硬件存在缺陷而导致的内存寻址问题所存在
  *  缺陷①：一些硬件只能用某些特定的内存地址（物理）来执行DMA（直接内存访问）
  *  缺陷②：一些体系结构的 内存的物理寻址范围比虚拟寻址范围大得多。这样，就有一些内存不能**永久**的映射到内核空间上。
  *  四种区：① ZONE_DMA： 这个区包含的页用来执行DMA操作。②ZONE_DMA32。③ZONE_NORMAL 这个包含的是能正常映射的页。④ZONE_HIGH 该区域包含高端内存，其中的页不能永久的映射到内核地址空间。
  *  linux通过将物理内存的页划分为区，形成不同的内存池，这样就可以根据用途进行分配了。（这里的分配指的是 拿到对应的物理页）
  *  每个区都是使用 `struct zone` 来表示。

*  内核提供了一些函数能够分配页，即：获取可用的页给当前的进程使用！
       
* 页表：


# 虚拟文件系统（VFS）
在真实的文件系统上又封装了一层，用来屏蔽不同文件系统的实现细节

VFS四个主要的对象：

1. 超级块对象
   * 该对象用于存储 特定文件系统的信息，通常对应于存放在 **磁盘特定扇区** 中的 **文件系统超级块** 或 **文件系统控制块**
   * super_operations: 内核针对 特定文件系统所能调用的方法，inode 的 create, destroy, write, drop ... 和 super 的 put, write 和 fs 的 sync, freeze ...
   * 
2. 索引节点对象
   * inode_operations: 针对特定文件所能调用的方法，比如：create，link
3. 目录项对象：代表的是路径的一个组成部分。
   * dentry_operations: 针对目录所能调用的方法，比如：d_compare, d_delete
4. 文件对象
   * 针对打开的文件所能调用的方法，read(), write
  


